weird infinite loops when lfil is set too low
disagreement with matlab implementation when tol is set higher.